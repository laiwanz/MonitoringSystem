# 设备端代码
### main.cpp 
- 填写已启动的Redis Server 的IP地址

# 各个模块图

### 基于Redis发布订阅的信息通道模块

- **发布订阅**的回调函数（setCallBack）
- 发布消息 publish
- 添加频道 add
- 两个回调函数，来构成三个模块互相独立又互相聚合的结构
- 最基础的模块之一

### 解包封包模块

- 协议格式的设计
    - 上报协议
    - 任务协议
    - 应答协议
- 它的功能在各个地方都起作用
    - 连接收发模块和执行任务模块
    - 进行数据的处理，解析或者封包
- JSON解析后续更新获取版本信息也用到
- 回调函数 将解析后的任务信息推送到任务模块进行执行

### 执行任务模块

- 回调函数，任务接收到，传给解析，解析完后传给执行任务的模块
    - 判断是否需要执行任务
    - 判断执行任务的类型、次数、间隔时间
    - 再抽象工厂模式构造出具体的执行任务类
        - 更新
        - 重启
        - 蜂鸣等
- 一个线程遍历任务列表
    - 利用时间戳来查询是否需要执行任务
    - 执行完后对私有成员变量记录的执行次数进行递减
    - 没有任务则进行休眠
- 一个线程进行时刻上报信息
    - 利用到了封包模块的功能，再用到收发模块的发布功能，利用回调函数进行模块之间的连接

### 具体的任务实现模块

- 任务模块的设计模式，抽象工厂模式，在实际生产的具体任务中有处理执行次数的函数和处理时间戳的函数
- 考虑到可扩展性，**抽象工厂模式**。

### 热更新模块
- Shell脚本自启动
- Shell脚本进行代码更新

# UI
## 运行步骤
执行前需要对其中的pro进行修改，在PC端上运行，将其外部库的middware 库修改成本机的目录，并重新构建
## 模块 
- 包含 Redis 发布订阅的收发功能
- 新建任务的子页面
- SSH 功能子页面
- 对接受到的设备上报信息进行解析处理并显示
- 各个任务对于各自的协议，点击即可发布到对应频道中
